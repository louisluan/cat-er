use distance,clearkeep iso* distcapdrop if iso_o==iso_dgsort iso_o -distcapby iso_o:gen tag=_ndrop if tag>5drop distcapreshape wide iso_d,i(iso_o) j(tag)save diswei,replaceuse gdp,clearren iso3 iso_omerge m:1 iso_o using disweidrop if _merge==2drop _mergegen d1=.gen d2=.gen d3=.gen d4=.gen d5=.			qui desc iso_oforeach v of varlist d1-d5{   forval i = 1/`r(N)'{		forval j = 1/`r(N)'{		   if iso_`v'[`j']==iso_o[`i'] & year[`j']==year[`i'] {			replace  `v'=GDP[`i'] if _n==`j'		}	 }		   }}